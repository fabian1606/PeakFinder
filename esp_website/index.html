<!DOCTYPE html>
<html lang="en">
  <head>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: Arial, Helvetica, sans-serif;
      }
      li {
        list-style: none;
        margin: 10px;
        margin-left: 0px;
        margin-right: 40px;
        padding: 10px;
        background-color: white;
        border-radius: 15px;
        border-bottom-left-radius: 0;
      }
      li.user-message {
        border-bottom-left-radius: 15px;
        border-bottom-right-radius: 0;
        margin-left: 40px;
        margin-right: 0px;
      }
      .open {
        height: 50vh !important ;
      }
      .open_text {
        display: block !important;
      }
      textarea {
        width: 100%;
        border-radius: 15px;
        padding: 5px;
        margin-bottom: 15px;
        outline: none;
      }
      .rotate {
        transform: rotate(180deg);
      }
    </style>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body style="background-color: lightblue">
    <div
      style="
        margin: 30px;
        margin-top: 0px;
        margin-bottom: 30px;
        padding: 20px;
        height: 100vh;
      "
    >
      <div
        style="
          display: flex;
          justify-content: center;
          position: fixed;
          background-color: #242227;
          width: 100%;
          height: 60px;
          top: 0;
          left: 0;
          padding: 10px;
        "
      >
        <svg
          width="40"
          height="40"
          viewBox="0 0 237 237"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <mask
            id="mask0_31_636"
            style="mask-type: alpha"
            maskUnits="userSpaceOnUse"
            x="0"
            y="0"
            width="237"
            height="237"
          >
            <circle cx="118.5" cy="118.5" r="118.5" fill="#D9D9D9" />
          </mask>
          <g mask="url(#mask0_31_636)">
            <g filter="url(#filter0_f_31_636)">
              <circle cx="113" cy="100" r="45" fill="#FCE9A3" />
            </g>
            <path
              d="M-1.5 148.62C-14.7 156.62 -23.3333 160.287 -26 161.12V260.62C82.3333 260.954 297.3 260.12 290.5 254.12C282 246.62 307.5 199.62 299 194.62C290.5 189.62 257 184.62 249.5 178.12C242 171.62 220.5 159.12 214.5 153.12C208.5 147.12 200 141.12 191 138.12C182 135.12 166 125.62 160.5 121.62C155 117.62 146.5 104.62 142.5 101.12C138.5 97.6204 119.5 88.1204 116 87.1204C112.5 86.1204 110 91.6204 108.5 93.6204C107 95.6204 97.5 100.12 94.5 101.12C91.5 102.12 85.5 111.12 83 110.62C80.5 110.12 76 111.12 72.5 113.12C69 115.12 62 117.62 56.5 117.62C51 117.62 50.5 124.62 43 127.62C37 130.02 27.5 128.62 23.5 127.62C20.6667 131.287 11.7 140.62 -1.5 148.62Z"
              fill="#1F3F5C"
            />
            <mask
              id="mask1_31_636"
              style="mask-type: alpha"
              maskUnits="userSpaceOnUse"
              x="-26"
              y="87"
              width="327"
              height="174"
            >
              <path
                d="M-1.5 148.62C-14.7 156.62 -23.3333 160.287 -26 161.12V260.62C82.3333 260.954 297.3 260.12 290.5 254.12C282 246.62 307.5 199.62 299 194.62C290.5 189.62 257 184.62 249.5 178.12C242 171.62 220.5 159.12 214.5 153.12C208.5 147.12 200 141.12 191 138.12C182 135.12 166 125.62 160.5 121.62C155 117.62 146.5 104.62 142.5 101.12C138.5 97.6204 119.5 88.1204 116 87.1204C112.5 86.1204 110 91.6204 108.5 93.6204C107 95.6204 97.5 100.12 94.5 101.12C91.5 102.12 85.5 111.12 83 110.62C80.5 110.12 76 111.12 72.5 113.12C69 115.12 62 117.62 56.5 117.62C51 117.62 50.5 124.62 43 127.62C37 130.02 27.5 128.62 23.5 127.62C20.6667 131.287 11.7 140.62 -1.5 148.62Z"
                fill="#1F3F5C"
              />
            </mask>
            <g mask="url(#mask1_31_636)">
              <path
                d="M144 114.62C141.2 109.02 129.167 96.287 123.5 90.6204H150.5L236 141.12L318.5 193.12V257.12L265 272.12L236 234.12L186.5 178.62L179.5 147.12C168.833 138.62 146.8 120.22 144 114.62Z"
                fill="#4576A3"
              />
              <path
                d="M9.5 120.62L-24.5 132.62L-35 155.12L-45.5 273.12L184 261.62C181.667 250.287 177 227.22 177 225.62C177 223.62 171.5 196.12 165.5 193.62C160.7 191.62 149.5 169.12 144.5 158.12L141.5 122.62C134.5 118.787 119.7 108.82 116.5 99.6203C113.3 90.4203 105.167 89.4537 101.5 90.1203L9.5 120.62Z"
                fill="#183249"
              />
            </g>
            <g filter="url(#filter1_f_31_636)">
              <path
                d="M-27 164L20.5 132.5L76 114L106 92H129.5L171.5 121L228 157.5L270 180.5L303.5 192"
                stroke="#F6943A"
                stroke-width="13"
              />
            </g>
            <path
              d="M98.5378 99.8444L98 101.113L99.4118 101.373L100.118 99.8444L100.555 98.5431L101.529 96.9491L101.866 96.0707L102.101 96.6888L101.529 99.8444L101.261 101.536L103.58 102.024V101.536L102.975 101.113L103.277 100.04L103.58 99.8444V98.0226L104.017 97.5347L103.815 96.9491L104.689 96.2334L104.218 95.3225L104.387 94.2164L103.58 92.0042L103.815 91.0608L103.58 88.9137H103.815L107.076 90.3126L107.277 90.0198L108.42 90.1499L108.958 90.5078L108.555 102.902L108.958 103L109.395 90.5078L110 90.0198V89.4017L109.395 89.0764V87.5474H108.958V89.0764H108.723L108.185 89.4017L106.605 88.9137L104.218 87.3522L104.017 85.2702L103.277 84.7496V84.3918L102.773 84.0014L103.58 83.5785L103.815 82.9279L104.218 82.6676L103.815 81.0736L104.218 80.6832L104.017 80H102.773H102.471H101.529L100.555 81.0736L100.118 81.8218L100.555 83.2207L101.261 83.5785V84.0014L100.924 84.3918H99.042V85.2702H98L98.5378 90.768H100.118V91.5163L99.4454 92.8501L99.8824 93.8586L99.4454 96.396L98.2017 99.8444H98.5378Z"
              fill="#2C3B47"
            />
            <g filter="url(#filter2_f_31_636)">
              <path
                d="M-27 164L20.5 132.5L76 114L106 92H129.5L171.5 121L228 157.5L270 180.5L303.5 192"
                stroke="#F6943A"
                stroke-opacity="0.1"
                stroke-width="13"
              />
            </g>
            <path
              d="M121 91L122 82M118.5 84C120.167 84.1667 123.9 84.7 125.5 85.5"
              stroke="#454E56"
            />
          </g>
          <defs>
            <filter
              id="filter0_f_31_636"
              x="66"
              y="53"
              width="94"
              height="94"
              filterUnits="userSpaceOnUse"
              color-interpolation-filters="sRGB"
            >
              <feFlood flood-opacity="0" result="BackgroundImageFix" />
              <feBlend
                mode="normal"
                in="SourceGraphic"
                in2="BackgroundImageFix"
                result="shape"
              />
              <feGaussianBlur
                stdDeviation="1"
                result="effect1_foregroundBlur_31_636"
              />
            </filter>
            <filter
              id="filter1_f_31_636"
              x="-130.592"
              y="-14.5"
              width="536.203"
              height="312.648"
              filterUnits="userSpaceOnUse"
              color-interpolation-filters="sRGB"
            >
              <feFlood flood-opacity="0" result="BackgroundImageFix" />
              <feBlend
                mode="normal"
                in="SourceGraphic"
                in2="BackgroundImageFix"
                result="shape"
              />
              <feGaussianBlur
                stdDeviation="50"
                result="effect1_foregroundBlur_31_636"
              />
            </filter>
            <filter
              id="filter2_f_31_636"
              x="-50.5923"
              y="65.5"
              width="376.203"
              height="152.648"
              filterUnits="userSpaceOnUse"
              color-interpolation-filters="sRGB"
            >
              <feFlood flood-opacity="0" result="BackgroundImageFix" />
              <feBlend
                mode="normal"
                in="SourceGraphic"
                in2="BackgroundImageFix"
                result="shape"
              />
              <feGaussianBlur
                stdDeviation="10"
                result="effect1_foregroundBlur_31_636"
              />
            </filter>
          </defs>
        </svg>

        <h2 style="margin-top: 7px; margin-left: 5px; color: #fbdf96">
          Peakfinder
        </h2>
      </div>
      <ul id="message_list" style="margin-top: 50px; margin-bottom: 60px"></ul>
    </div>
    <div
      id="drawer"
      style="
        display: flex;
        flex-direction: column;
        align-items: center;
        background-color: #242227;
        position: fixed;
        bottom: 0;
        height: 7vh;
        width: 100%;
      "
    >
      <button id="iconButtom" style="background-color: #24222700; border: 0">
        <svg
          id="chevron"
          width="40"
          height="40"
          id="Ebene_1"
          data-name="Ebene 1"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 48 48"
        >
          <defs>
            <style>
              .cls-1 {
                fill: #fbdf96;
              }
            </style>
          </defs>
          <path
            class="cls-1"
            d="m14.15,30.75l-2.15-2.15,12-12,12,11.95-2.15,2.15-9.85-9.85-9.85,9.9Z"
          />
        </svg>
      </button>
      <div id="text_areas" style="display: none; padding: 5px">
        <div style="display: flex; flex-direction: column">
          <p style="color: white">Your Email</p>
          <p style="color: white; font-size: small; margin-bottom: 2px">
            is necessary if you want to use the app later on
          </p>
          <textarea
            class="drawer_text"
            name="email"
            id="email"
            cols="30"
            rows="1"
            placeholder="email"
          ></textarea>
          <p style="color: white">Your Message</p>
          <p style="color: white; font-size: small; margin-bottom: 2px">
            will be displayed among all the other messages
          </p>
          <textarea
            class="drawer_text"
            name="text"
            id="text"
            cols="30"
            rows="3"
            placeholder="your message"
          ></textarea>
        </div>
        <button
          id="entry"
          style="
            float: right;
            height: 25px;
            width: 60px;
            border: 0;
            border-radius: 10px;
          "
        >
          entry
        </button>
      </div>
    </div>
  </body>
</html>
<script>
  document.getElementById("iconButtom").addEventListener("click", function () {
    document.getElementById("drawer").classList.toggle("open");
    document.getElementById("text_areas").classList.toggle("open_text");
    document.getElementById("chevron").classList.toggle("rotate");
  });

  let messages;

  fetch("http://localhost:3004/testget")
    .then((response) => response.json())
    .then((data) => {
      messages = data.arr;
      console.log(data.arr);
      loadMessages();
    })
    .catch((error) => {
      console.error("Error:", error);
    });

  function loadMessages() {
    if (messages != undefined) {
      document.getElementById("message_list").innerHTML = messages
        .map((message) => {
          return `<li class="${message.email ? "user-message" : "message"}"}">
                    <p>${message.msg}</p>
                    </li>`;
        })
        .join("");
    }
  }

  if (localStorage.getItem("used") == null) {
    localStorage.setItem("used", false);
  }

  document.getElementById("entry").addEventListener("click", function () {
    if (localStorage.getItem("used") == "false") {
      localStorage.setItem("used", true);
      const email = document.getElementById("email").value;
      const text = document.getElementById("text").value;
      if (text == "") {
        alert("please enter a message");
        return;
      }
      if (email == "") {
        alert("please enter an email");
        return;
      }
      const message = {
        email: email,
        msg: text,
      };
      console.log(message);
      messages.unshift(message);

      fetch("http://localhost:3004/testpost", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify(message),
      })
        .then((response) => console.log(response))
        .catch((error) => {
          console.error("Error:", error);
        });
      loadMessages();
    }
  });
</script>
